"use strict";function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof(obj);}require("core-js/modules/es.object.set-prototype-of.js");require("core-js/modules/es.object.get-prototype-of.js");require("core-js/modules/es.reflect.construct.js");require("core-js/modules/es.symbol.js");require("core-js/modules/es.symbol.description.js");require("core-js/modules/es.symbol.iterator.js");require("core-js/modules/es.array.iterator.js");require("core-js/modules/web.dom-collections.iterator.js");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;require("core-js/modules/es.object.to-string.js");require("core-js/modules/es.regexp.to-string.js");require("core-js/modules/es.array.find.js");require("core-js/modules/es.array.find-index.js");require("core-js/modules/es.array.sort.js");require("core-js/modules/es.array.from.js");require("core-js/modules/es.string.iterator.js");require("core-js/modules/es.number.constructor.js");require("core-js/modules/es.array.map.js");var _react=_interopRequireDefault(require("react"));var _reactDom=_interopRequireDefault(require("react-dom"));var _propTypes=_interopRequireDefault(require("prop-types"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function");}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass);}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o;};return _setPrototypeOf(o,p);}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call;}else if(call!==void 0){throw new TypeError("Derived constructors may only return object or undefined");}return _assertThisInitialized(self);}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return self;}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true;}catch(e){return false;}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o);};return _getPrototypeOf(o);}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}var ENTER='Enter';var SPACE=String.fromCharCode(32);var isKeyEnter=function isKeyEnter(_ref){var key=_ref.key;return key===ENTER;};var isKeySpace=function isKeySpace(_ref2){var key=_ref2.key;return key===SPACE;};var isEventClickLike=function isEventClickLike(_ref3){var pageX=_ref3.pageX,pageY=_ref3.pageY,screenX=_ref3.screenX,screenY=_ref3.screenY;return!(pageX||pageY||screenX||screenY);};var toOptionText=function toOptionText(t){return t!==undefined?t.toString():"\uFEFF";};var forward=function forward(alpha,omega){return alpha<omega?-1:alpha>omega?+1:0;};var reverse=function reverse(alpha,omega){return alpha<omega?+1:alpha>omega?-1:0;};var forwardByOptionText=function forwardByOptionText(_ref4,_ref5){var alpha=_ref4.text;var omega=_ref5.text;return forward(toOptionText(alpha).toLowerCase(),toOptionText(omega).toLowerCase());};var reverseByOptionText=function reverseByOptionText(_ref6,_ref7){var alpha=_ref6.text;var omega=_ref7.text;return reverse(toOptionText(alpha).toLowerCase(),toOptionText(omega).toLowerCase());};var exactMatchFor=function exactMatchFor(chars){return function(_ref8){var text=_ref8.text;return toOptionText(text).toLowerCase()===chars;};};var startMatchFor=function startMatchFor(chars){var n=chars.length;return function(_ref9){var text=_ref9.text;return toOptionText(text).toLowerCase().substr(0,n)===chars;};};var match=function match(option){return function(o){return option===o;};};var greaterThanFor=function greaterThanFor(chars){return function(_ref10){var text=_ref10.text;return toOptionText(text).toLowerCase()>chars;};};var smallerThanFor=function smallerThanFor(chars){return function(_ref11){var text=_ref11.text;return toOptionText(text).toLowerCase()<chars;};};var getExactMatch=function getExactMatch(options,chars){return options.find(exactMatchFor(chars));};var hasExactMatch=function hasExactMatch(options,chars){return options.some(exactMatchFor(chars));};var getExactMatchIndex=function getExactMatchIndex(options,chars){return options.findIndex(match(getExactMatch(options,chars)));};var getStartMatch=function getStartMatch(options,chars){return options.find(startMatchFor(chars));};var hasStartMatch=function hasStartMatch(options,chars){return options.some(startMatchFor(chars));};var getStartMatchIndex=function getStartMatchIndex(options,chars){return options.findIndex(match(getStartMatch(options,chars)));};var getGreaterThanMatch=function getGreaterThanMatch(options,chars){return options.find(greaterThanFor(chars));};var hasGreaterThanMatch=function hasGreaterThanMatch(options,chars){return options.some(greaterThanFor(chars));};var getGreaterThanMatchIndex=function getGreaterThanMatchIndex(options,chars){return options.findIndex(match(getGreaterThanMatch(Array.from(options).sort(forwardByOptionText),chars)));};var getSmallerThanMatch=function getSmallerThanMatch(options,chars){return options.find(smallerThanFor(chars));};var hasSmallerThanMatch=function hasSmallerThanMatch(options,chars){return options.some(smallerThanFor(chars));};var getSmallerThanMatchIndex=function getSmallerThanMatchIndex(options,chars){return options.findIndex(match(getSmallerThanMatch(Array.from(options).sort(reverseByOptionText),chars)));};var getSelectIndex=function getSelectIndex(_ref12){var index=_ref12.index,defaultIndex=_ref12.defaultIndex;return!isNaN(index)?Number(index):Number(defaultIndex);};var SelectElement=function(_React$Component){_inherits(SelectElement,_React$Component);var _super=_createSuper(SelectElement);function SelectElement(props){var _this;_classCallCheck(this,SelectElement);_this=_super.call(this,props);_defineProperty(_assertThisInitialized(_this),"handleFocus",function(){var selectIndex=_this.state.selectIndex;_this.activeIndex(selectIndex);});_defineProperty(_assertThisInitialized(_this),"handleBlur",function(){_this.setState({hasActiveOptions:false});});_defineProperty(_assertThisInitialized(_this),"handleMouseEnter",function(){_this.setState({activeEnter:true});});_defineProperty(_assertThisInitialized(_this),"handleMouseLeave",function(){_this.setState({activeEnter:false});});_defineProperty(_assertThisInitialized(_this),"handleActiveEnterFocus",function(){return true;});_defineProperty(_assertThisInitialized(_this),"handleActiveEnterBlur",function(){_this.selectOptionFocus();});_defineProperty(_assertThisInitialized(_this),"handleClick",function(event){if(isEventClickLike(event)){_this.selectOptionFocus();}else{_this.setState({hasActiveOptions:true});}});_defineProperty(_assertThisInitialized(_this),"handleOptionClick",function(index){_this.setState({hasActiveOptions:false});_this.selectIndex(index);_this.selectOptionFocus();});_defineProperty(_assertThisInitialized(_this),"handleActiveOptionsKeyPress",function(event){if(isKeyEnter(event)||isKeySpace(event))return;return _this.handleActiveOptionsKeyChar(event);});_defineProperty(_assertThisInitialized(_this),"handleKeyPress",function(event){return _this.handleKeyChar(event);});_defineProperty(_assertThisInitialized(_this),"handleActiveOptionsKeyUp",function(event){return _this.handleActiveOptionsKeyCode(event);});_defineProperty(_assertThisInitialized(_this),"handleActiveOptionsKeyDown",function(){return true;});_defineProperty(_assertThisInitialized(_this),"handleKeyUp",function(event){return _this.handleKeyCode(event);});_defineProperty(_assertThisInitialized(_this),"handleKeyDown",function(){return true;});_defineProperty(_assertThisInitialized(_this),"selectOptionRef",function(ref){return ref?!!(_this.selectOption=ref):delete _this.selectOption;});_defineProperty(_assertThisInitialized(_this),"optionsRef",function(ref){return ref?!!(_this.options=ref):delete _this.options;});_defineProperty(_assertThisInitialized(_this),"activeOptionRef",function(ref){return ref?!!(_this.activeOption=ref):delete _this.activeOption;});_defineProperty(_assertThisInitialized(_this),"createOptionRef",function(index){var activeIndex=_this.state.activeIndex;if(index===activeIndex){return _this.activeOptionRef;}});_defineProperty(_assertThisInitialized(_this),"createOptionDisabled",function(option,index){var text=option.text;return _react.default.createElement("li",{key:index,className:"option"},toOptionText(text));});_defineProperty(_assertThisInitialized(_this),"createOptionReadOnly",function(option,index){var text=option.text;return _react.default.createElement("li",{key:index,className:"option"},toOptionText(text));});_defineProperty(_assertThisInitialized(_this),"createOption",function(option,index){var text=option.text;return _react.default.createElement("li",{key:index,ref:_this.createOptionRef(index),className:_this.createOptionClassName(index),onMouseOver:function onMouseOver(){return _this.activeIndex(index);},onClick:function onClick(){return _this.handleOptionClick(index);}},toOptionText(text));});_this.state={selectIndex:getSelectIndex(props),hasActiveOptions:false,activeEnter:false,activeIndex:0,activeChars:''};return _this;}_createClass(SelectElement,[{key:"lowerBound",get:function get(){return 0;}},{key:"upperBound",get:function get(){var n=this.props.options.length;return Math.max(0,n-1);}},{key:"scrollOptionIntoView",value:function scrollOptionIntoView(element){if(_reactDom.default.findDOMNode(this).contains(element)){var options=this.options;var offsetTop=element.offsetTop,offsetHeight=element.offsetHeight;var scrollTop=options.scrollTop,clientHeight=options.clientHeight;var i=clientHeight/2;var j=offsetHeight/2;var n=Math.max(0,offsetTop-i+j);if(n!==scrollTop)options.scrollTop=n;}}},{key:"toLowerBound",value:function toLowerBound(){this.setState({activeIndex:this.lowerBound});}},{key:"toUpperBound",value:function toUpperBound(){this.setState({activeIndex:this.upperBound});}},{key:"selectOptionFocus",value:function selectOptionFocus(){this.selectOption.focus();}},{key:"handleKeySpace",value:function handleKeySpace(){this.setState({hasActiveOptions:false});var activeIndex=this.state.activeIndex;this.selectIndex(activeIndex);}},{key:"handleKeyEnter",value:function handleKeyEnter(){this.setState({hasActiveOptions:false});var activeIndex=this.state.activeIndex;this.selectIndex(activeIndex);}},{key:"handleKeyEscape",value:function handleKeyEscape(){this.setState({hasActiveOptions:false});}},{key:"getOptionsFirstChild",value:function getOptionsFirstChild(){return this.options.firstChild||null;}},{key:"getOptionsLastChild",value:function getOptionsLastChild(){return this.options.lastChild||null;}},{key:"getActiveOptionPreviousSibling",value:function getActiveOptionPreviousSibling(){return this.activeOption.previousSibling||null;}},{key:"getActiveOptionNextSibling",value:function getActiveOptionNextSibling(){return this.activeOption.nextSibling||null;}},{key:"handleKeyArrowUp",value:function handleKeyArrowUp(){this.decrementActiveIndex();this.setState({activeChars:''});}},{key:"handleKeyArrowDown",value:function handleKeyArrowDown(){this.incrementActiveIndex();this.setState({activeChars:''});}},{key:"handleActiveOptionsKeyChar",value:function handleActiveOptionsKeyChar(_ref13){var keyChar=_ref13.charCode;var activeChars=this.state.activeChars;var options=this.props.options;var char=String.fromCharCode(keyChar).toLowerCase();var chars=activeChars+char;if(hasExactMatch(options,chars)){this.setState({activeChars:chars});this.activeIndex(getExactMatchIndex(options,chars));}else{if(hasStartMatch(options,chars)){this.setState({activeChars:chars});this.activeIndex(getStartMatchIndex(options,chars));}else{if(hasExactMatch(options,char)){this.setState({activeChars:char});this.activeIndex(getExactMatchIndex(options,char));}else{if(hasStartMatch(options,char)){this.setState({activeChars:char});this.activeIndex(getStartMatchIndex(options,char));}else{if(hasGreaterThanMatch(options,char)){this.setState({activeChars:''});this.activeIndex(getGreaterThanMatchIndex(options,char));}else{if(hasSmallerThanMatch(options,char)){this.setState({activeChars:''});this.activeIndex(getSmallerThanMatchIndex(options,char));}}}}}}}},{key:"handleKeyChar",value:function handleKeyChar(_ref14){var keyChar=_ref14.charCode;var activeChars=this.state.activeChars;var options=this.props.options;var char=String.fromCharCode(keyChar).toLowerCase();var chars=activeChars+char;if(hasExactMatch(options,chars)){this.setState({activeChars:chars});this.selectIndex(getExactMatchIndex(options,chars));}else{if(hasStartMatch(options,chars)){this.setState({activeChars:chars});this.selectIndex(getStartMatchIndex(options,chars));}else{if(hasExactMatch(options,char)){this.setState({activeChars:char});this.selectIndex(getExactMatchIndex(options,char));}else{if(hasStartMatch(options,char)){this.setState({activeChars:char});this.selectIndex(getStartMatchIndex(options,char));}else{if(hasGreaterThanMatch(options,char)){this.setState({activeChars:''});this.selectIndex(getGreaterThanMatchIndex(options,char));}}}}}}},{key:"handleActiveOptionsKeyCode",value:function handleActiveOptionsKeyCode(event){var keyCode=event.keyCode;switch(keyCode){case 13:this.handleKeyEnter(event);break;case 27:this.handleKeyEscape(event);break;case 32:this.handleKeySpace(event);break;case 38:this.handleKeyArrowUp(event);break;case 40:this.handleKeyArrowDown(event);break;}}},{key:"handleKeyCode",value:function handleKeyCode(_ref15){var keyCode=_ref15.keyCode;if(keyCode===32||keyCode===38||keyCode===40){this.setState({hasActiveOptions:true});}}},{key:"selectIndex",value:function selectIndex(index){var selectIndex=this.state.selectIndex;if(index!==selectIndex){var onChange=this.props.onChange;if(onChange instanceof Function)onChange(index);if('index'in this.props)return;this.setState({selectIndex:index});}}},{key:"activeIndex",value:function activeIndex(index){var activeIndex=this.state.activeIndex;if(index!==activeIndex){this.setState({activeIndex:index});}}},{key:"decrementActiveIndex",value:function decrementActiveIndex(){var activeIndex=this.state.activeIndex;this.activeIndex(Math.max(activeIndex-1,this.lowerBound));}},{key:"incrementActiveIndex",value:function incrementActiveIndex(){var activeIndex=this.state.activeIndex;this.activeIndex(Math.min(activeIndex+1,this.upperBound));}},{key:"createSelectedOptionDisabled",value:function createSelectedOptionDisabled(){var options=this.props.options;var selectIndex=this.state.selectIndex;var _ref16=options[selectIndex]||{},text=_ref16.text;return _react.default.createElement("div",{className:"selected-option"},toOptionText(text));}},{key:"createSelectedOptionReadOnly",value:function createSelectedOptionReadOnly(){var options=this.props.options;var selectIndex=this.state.selectIndex;var _ref17=options[selectIndex]||{},text=_ref17.text;return _react.default.createElement("div",{className:"selected-option"},toOptionText(text));}},{key:"createSelectedOption",value:function createSelectedOption(){var _this$props=this.props,options=_this$props.options,accessKey=_this$props.accessKey,tabIndex=_this$props.tabIndex;var _this$state=this.state,selectIndex=_this$state.selectIndex,activeEnter=_this$state.activeEnter,hasActiveOptions=_this$state.hasActiveOptions;var _ref18=options[selectIndex]||{},text=_ref18.text;return _react.default.createElement("div",{ref:this.selectOptionRef,accessKey:accessKey,tabIndex:tabIndex,className:"selected-option",onFocus:activeEnter?this.handleActiveEnterFocus:this.handleFocus,onBlur:activeEnter?this.handleActiveEnterBlur:this.handleBlur,onClick:this.handleClick,onKeyPress:hasActiveOptions?this.handleActiveOptionsKeyPress:this.handleKeyPress,onKeyUp:hasActiveOptions?this.handleActiveOptionsKeyUp:this.handleKeyUp,onKeyDown:hasActiveOptions?this.handleActiveOptionsKeyDown:this.handleKeyDown},toOptionText(text));}},{key:"createOptionClassName",value:function createOptionClassName(index){var activeIndex=this.state.activeIndex;return index===activeIndex?'option active':'option';}},{key:"createOptionsClassName",value:function createOptionsClassName(){var hasActiveOptions=this.state.hasActiveOptions;return hasActiveOptions?'options active':'options';}},{key:"createOptionsDisabled",value:function createOptionsDisabled(){var options=this.props.options;if(options.length){return _react.default.createElement("ul",{className:"options"},options.map(this.createOptionDisabled));}}},{key:"createOptionsReadOnly",value:function createOptionsReadOnly(){var options=this.props.options;if(options.length){return _react.default.createElement("ul",{className:"options"},options.map(this.createOptionReadOnly));}}},{key:"createOptions",value:function createOptions(){var options=this.props.options;if(options.length){return _react.default.createElement("ul",{ref:this.optionsRef,className:this.createOptionsClassName(),onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave},options.map(this.createOption));}}},{key:"shouldComponentUpdate",value:function shouldComponentUpdate(props,state){if(props!==this.props)return true;return state.selectIndex!==this.state.selectIndex||state.hasActiveOptions!==this.state.hasActiveOptions||state.activeEnter!==this.state.activeEnter||state.activeIndex!==this.state.activeIndex;}},{key:"renderDisabled",value:function renderDisabled(){return _react.default.createElement("div",{className:"react-select-element disabled"},this.createSelectedOptionDisabled(),this.createOptionsDisabled());}},{key:"renderReadOnly",value:function renderReadOnly(){return _react.default.createElement("div",{className:"react-select-element readonly"},this.createSelectedOptionReadOnly(),this.createOptionsReadOnly());}},{key:"render",value:function render(){var disabled=this.props.disabled;if(disabled){return this.renderDisabled();}var readOnly=this.props.readOnly;if(readOnly){return this.renderReadOnly();}return _react.default.createElement("div",{className:"react-select-element"},this.createSelectedOption(),this.createOptions());}}],[{key:"getDerivedStateFromProps",value:function getDerivedStateFromProps(props){return'index'in props?{selectIndex:getSelectIndex(props)}:null;}}]);return SelectElement;}(_react.default.Component);exports.default=SelectElement;SelectElement.propTypes={defaultIndex:_propTypes.default.oneOfType([_propTypes.default.number,_propTypes.default.string]),index:_propTypes.default.oneOfType([_propTypes.default.number,_propTypes.default.string]),tabIndex:_propTypes.default.number,options:_propTypes.default.arrayOf(_propTypes.default.shape({text:_propTypes.default.oneOfType([_propTypes.default.number,_propTypes.default.string,_propTypes.default.bool])})),onChange:_propTypes.default.func,accessKey:_propTypes.default.string,disabled:_propTypes.default.bool,readOnly:_propTypes.default.bool};SelectElement.defaultProps={defaultIndex:0,tabIndex:0,options:[],disabled:false,readOnly:false};